<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>rsa学习终结 | 榉橡的博客</title><meta name="keywords" content="CTF"><meta name="author" content="榉橡"><meta name="copyright" content="榉橡"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="RSA学习终结—-例题密钥d的生成题目  在一次RSA密钥对生成中，假设p&#x3D;473398607161，q&#x3D;4511491，e&#x3D;17求解出d作为flga提交 1234567import gmpy2p&#x3D;4733986071671q&#x3D;4511491e&#x3D;17n &#x3D; p*qd &#x3D; gmpy2.invert(e, (p - 1) * (q - 1))print(d) 答案125631357777427553">
<meta property="og:type" content="article">
<meta property="og:title" content="rsa学习终结">
<meta property="og:url" content="http://example.com/2021/03/23/rsa%E5%AD%A6%E4%B9%A0%E7%BB%88%E7%BB%93/index.html">
<meta property="og:site_name" content="榉橡的博客">
<meta property="og:description" content="RSA学习终结—-例题密钥d的生成题目  在一次RSA密钥对生成中，假设p&#x3D;473398607161，q&#x3D;4511491，e&#x3D;17求解出d作为flga提交 1234567import gmpy2p&#x3D;4733986071671q&#x3D;4511491e&#x3D;17n &#x3D; p*qd &#x3D; gmpy2.invert(e, (p - 1) * (q - 1))print(d) 答案125631357777427553">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="e:/blog/themes/butterfly/source/img">
<meta property="article:published_time" content="2021-03-23T02:15:10.000Z">
<meta property="article:modified_time" content="2021-03-24T15:55:03.318Z">
<meta property="article:author" content="榉橡">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="e:/blog/themes/butterfly/source/img"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2021/03/23/rsa%E5%AD%A6%E4%B9%A0%E7%BB%88%E7%BB%93/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-24 23:55:03'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: E:\blog\themes\butterfly\source\img"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">榉橡的博客</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">rsa学习终结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-03-23T02:15:10.000Z" title="发表于 2021-03-23 10:15:10">2021-03-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-24T15:55:03.318Z" title="更新于 2021-03-24 23:55:03">2021-03-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="RSA学习终结—-例题"><a href="#RSA学习终结—-例题" class="headerlink" title="RSA学习终结—-例题"></a>RSA学习终结—-例题</h1><h2 id="密钥d的生成"><a href="#密钥d的生成" class="headerlink" title="密钥d的生成"></a>密钥d的生成</h2><p>题目 </p>
<p>在一次RSA密钥对生成中，假设p=473398607161，q=4511491，e=17<br>求解出d作为flga提交</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="number">4733986071671</span></span><br><span class="line">q=<span class="number">4511491</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>
<p>答案125631357777427553</p>
<h2 id="解密（已知p-q-e-c）"><a href="#解密（已知p-q-e-c）" class="headerlink" title="解密（已知p,q,e,c）"></a>解密（已知p,q,e,c）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q=<span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="string">b&#x27;Hello World&#x27;</span></span><br><span class="line">m = bytes_to_long(m)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">print(c)</span><br><span class="line">print(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
<h2 id="解密（已知p-q-dp-dq-c）"><a href="#解密（已知p-q-dp-dq-c）" class="headerlink" title="解密（已知p,q,dp,dq,c）"></a>解密（已知p,q,dp,dq,c）</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q=<span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp=<span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq=<span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c=<span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br></pre></td></tr></table></figure>
<p>首先先解释dp,dq的含义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dp&#x3D;d%(p-1)     </span><br><span class="line">dq&#x3D;d%(q-1)</span><br></pre></td></tr></table></figure>
<p>这种参数是为了让解密的时候更快速而产生的</p>
<p>献上代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q=<span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp=<span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq=<span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c=<span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">I = gmpy2.invert(q,p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c,dq,q)               <span class="comment">#求幂取模运算</span></span><br><span class="line"></span><br><span class="line">m = (((mp-mq)*I)%p)*q+mq       <span class="comment">#求明文公式</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">hex</span>(m))          <span class="comment">#转为十六进制</span></span><br></pre></td></tr></table></figure>
<p>一切不思考的抄代码，都是耍流氓 详细解释全  <a target="_blank" rel="noopener" href="https://blog.csdn.net/MikeCoke/article/details/105959599">https://blog.csdn.net/MikeCoke/article/details/105959599</a></p>
<h2 id="共模攻击（两段密文，n相同）"><a href="#共模攻击（两段密文，n相同）" class="headerlink" title="共模攻击（两段密文，n相同）"></a>共模攻击（两段密文，n相同）</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br></pre></td></tr></table></figure>
<h4 id="rsa共模攻击数学原理-https-blog-csdn-net-MikeCoke-article-details-106065200"><a href="#rsa共模攻击数学原理-https-blog-csdn-net-MikeCoke-article-details-106065200" class="headerlink" title="rsa共模攻击数学原理   https://blog.csdn.net/MikeCoke/article/details/106065200"></a>rsa共模攻击数学原理   <a target="_blank" rel="noopener" href="https://blog.csdn.net/MikeCoke/article/details/106065200">https://blog.csdn.net/MikeCoke/article/details/106065200</a></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="comment"># 欧几里得算法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">  <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    g, y, x = egcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">  n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">  c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">  c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">  e1 = <span class="number">11187289</span></span><br><span class="line">  e2 = <span class="number">9647291</span></span><br><span class="line">  s = egcd(e1, e2)</span><br><span class="line">  s1 = s[<span class="number">1</span>]</span><br><span class="line">  s2 = s[<span class="number">2</span>]</span><br><span class="line">  <span class="comment"># 求模反元素</span></span><br><span class="line">  <span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">    s1 = - s1</span><br><span class="line">    c1 = invert(c1, n)</span><br><span class="line">  <span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">    s2 = - s2</span><br><span class="line">    c2 = invert(c2, n)</span><br><span class="line"></span><br><span class="line">  m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line">  <span class="built_in">print</span> (libnum.n2s(m))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="dp泄露（已知n-e-dp-c）"><a href="#dp泄露（已知n-e-dp-c）" class="headerlink" title="dp泄露（已知n,e,dp,c）"></a>dp泄露（已知n,e,dp,c）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n=<span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp=<span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):                   <span class="comment">#在范围(1,e)之间进行遍历</span></span><br><span class="line">    <span class="keyword">if</span>(dp*e-<span class="number">1</span>)%i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n%(((dp*e-<span class="number">1</span>)//i)+<span class="number">1</span>) == <span class="number">0</span>:   <span class="comment">#存在p，使得n能被p整除</span></span><br><span class="line">            p=((dp*e-<span class="number">1</span>)//i)+<span class="number">1</span></span><br><span class="line">            q=n//(((dp*e-<span class="number">1</span>)//i)+<span class="number">1</span>)</span><br><span class="line">            phi=(q-<span class="number">1</span>)*(p-<span class="number">1</span>)            <span class="comment">#欧拉定理</span></span><br><span class="line">            d=gp.invert(e,phi)         <span class="comment">#求模逆</span></span><br><span class="line">            m=<span class="built_in">pow</span>(c,d,n)               <span class="comment">#快速求幂取模运算</span></span><br><span class="line">           </span><br><span class="line">print(m)                               <span class="comment">#10进制明文</span></span><br><span class="line">print(<span class="string">&#x27;------------&#x27;</span>)</span><br><span class="line">print(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])                      <span class="comment">#16进制明文</span></span><br><span class="line">print(<span class="string">&#x27;------------&#x27;</span>)</span><br><span class="line">print(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))       <span class="comment">#16进制转文本</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>数学原理<a target="_blank" rel="noopener" href="https://blog.csdn.net/MikeCoke/article/details/106095234">https://blog.csdn.net/MikeCoke/article/details/106095234</a></p>
<h2 id="公钥加签（给出公钥文件和加密文件）"><a href="#公钥加签（给出公钥文件和加密文件）" class="headerlink" title="公钥加签（给出公钥文件和加密文件）"></a>公钥加签（给出公钥文件和加密文件）</h2><p>打开公钥文件放入相关软件或者利用linux的opensll</p>
<p>得到模数n，放到质数分解网站或者yasu跑出p,q</p>
<p>可利用p,q,e得到d</p>
<p>利用脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">n= <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p= <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q= <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">d= <span class="number">81176168860169991027846870170527607562179635470395365333547868786951080991441</span></span><br><span class="line"></span><br><span class="line">key = rsa.PrivateKey(n,e,d,q,p)         <span class="comment">#在pkcs标准中,pkcs#1规定,私钥包含(n,e,d,p,q)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;C:\\Users\\MIKEWYW\\Desktop\\flagenc.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:  <span class="comment">#以二进制读模式，读取密文  </span></span><br><span class="line">    f = f.read()</span><br><span class="line">    print(rsa.decrypt(f,key))           <span class="comment"># f:公钥加密结果  key:私钥</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -pubin -text -modulus -in pubkey.pem</span><br><span class="line"></span><br><span class="line">python rsatool.py -f PEM -o private.pem -p 17 -q 13</span><br><span class="line"></span><br><span class="line">openssl rsautl -decrypt -in flag.enc -inkey private.pem</span><br></pre></td></tr></table></figure>
<h1 id="rsaroll"><a href="#rsaroll" class="headerlink" title="rsaroll"></a>rsaroll</h1><p>很简单的一道题‘</p>
<p>在data.txt有n和e,就是所谓的公钥信息，剩下的自然就是加密信息</p>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p =  <span class="number">18443</span></span><br><span class="line">q =  <span class="number">49891</span></span><br><span class="line">e =  <span class="number">19</span></span><br><span class="line">n = <span class="number">920139713</span></span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;C:\\Users\\****\\Desktop\\data.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    line = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> line:</span><br><span class="line">        i = i.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        print(<span class="built_in">str</span>(long_to_bytes(<span class="built_in">pow</span>(<span class="built_in">int</span>(i),d,n)))[<span class="number">2</span>:-<span class="number">1</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="e过小"><a href="#e过小" class="headerlink" title="e过小"></a>e过小</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = <span class="number">167301374477410718629594349645281326914434089992530877687003211679782894661758575488565941682050432268001204338578075919668073694767856492057865133587390911825807060433946917820651370344053528328094902693603505568585118920750295647737371418701653965110274085034584682022391405126061404348676703127840773433213906071664938863708646689806198452683548410312536652311486232204374119918052665188194284082981993123933019126250635236195620505623310226819070724330540988059137297320456628211063635075781377794363289036742972802441829857821669593841667056844922354061345810344570226493725115159881741439056901709252614302103855</span></span><br><span class="line">c = <span class="number">2217344750798296091193230394221582894657909643174934416842588335871298152598368701484028832407289746218387783855373449002121088413603751014125921242419602155087438902181522441026460003722677539409576093794862185483713606547386172606576925933695952279401957552813065318376293</span></span><br><span class="line">m ,flag = gp.iroot(c,<span class="number">3</span>)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>根据公式，c = m^e  %     n</p>
<p>如果 m^e  &lt; n     那对c开e次方根就可以得到密文了   e很小，n很大</p>
<p>c + kn   ==   m^e    </p>
<p>对e不大的情况可以尝试爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line">e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(d)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>此题N不大，用楼上的质因数分解也同样可以求出d</p>
<p>但此时的e很大，符合低解密指数的特征</p>
<p>winner 攻击利用脚本<strong>rsa-wiener-attack</strong></p>
<p>在文件夹下创建py文件，内容如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  RSAwienerHacker</span><br><span class="line">n = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line">e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line">d =  RSAwienerHacker.hack_RSA(e,n)</span><br><span class="line"><span class="keyword">if</span> d:</span><br><span class="line">    print(d)</span><br></pre></td></tr></table></figure>


<h2 id="低加密指数广播攻击"><a href="#低加密指数广播攻击" class="headerlink" title="低加密指数广播攻击"></a>低加密指数广播攻击</h2><p>使用条件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.加密指数e非常小</span><br><span class="line">2.一份明文使用不同的模数n，相同的加密指数e进行多次加密</span><br><span class="line">3.可以拿到每一份加密后的密文和对应的模数n、加密指数e</span><br></pre></td></tr></table></figure>
<p>Rsa5.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">m &#x3D; xxxxxxxx</span><br><span class="line">e &#x3D; 65537</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; n c &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">n &#x3D; 204749188…………</span><br><span class="line">c &#x3D; 974463908…………</span><br><span class="line"></span><br><span class="line">n &#x3D; 20918819…………</span><br><span class="line">c &#x3D; 1581963620…………</span><br><span class="line"></span><br><span class="line">n &#x3D; 25033254…………</span><br><span class="line">c &#x3D; 418530852941…………</span><br><span class="line"></span><br><span class="line">n &#x3D; 2120696809…………</span><br><span class="line">c &#x3D; 4521…………</span><br><span class="line"></span><br><span class="line">…………</span><br></pre></td></tr></table></figure>
<p>可以看到是共用一个明文且e相同</p>
<p>但他们的模数不相同</p>
<p>本题有个比较巧的方法，因为拥有多组的n,可以两两之间进行gcd，求出最大公约数，只要非1就行，p就得出，</p>
<p>利用当时的n整除p得到q,得到q，p, 等于  等到flag。</p>
<p>但如果各个模数都是互质的这种方法无效</p>
<p>利用**<em>中国剩余定理**</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extended_gcd</span>(<span class="params">a,b</span>):</span><span class="comment">#扩展欧几里得</span></span><br><span class="line">    x, y = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    lastx, lasty = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, (q, b) = b, <span class="built_in">divmod</span>(a, b)</span><br><span class="line">        x, lastx = lastx - q * x, x</span><br><span class="line">        y, lasty = lasty - q * y, y</span><br><span class="line">    <span class="keyword">return</span> (lastx, lasty, a)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chinese_remainder_theorem</span>(<span class="params">items</span>):</span><span class="comment">#中国剩余定理</span></span><br><span class="line">    N = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> a, n <span class="keyword">in</span> items:</span><br><span class="line">        N *= n</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> a, n <span class="keyword">in</span> items:</span><br><span class="line">        m = N // n</span><br><span class="line">        r, s, d = extended_gcd(n, m)</span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span>:</span><br><span class="line">            N = N / n</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># raise &quot;Input not pairwise co-prime&quot;</span></span><br><span class="line">        result += a * s * m</span><br><span class="line">    <span class="keyword">return</span> result % N, N</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sessions = [&#123;<span class="string">&quot;c&quot;</span>: <span class="number">7366067574741171461722065133242916080495505913663250330082747465383676893970411476550748394841437418105312353971095003424322679616940371123028982189502042</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">25162507052339714421839688873734596177751124036723831003300959761137811490715205742941738406548150240861779301784133652165908227917415483137585388986274803</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">21962825323300469151795920289886886562790942771546858500842179806566435767103803978885148772139305484319688249368999503784441507383476095946258011317951461</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">23976859589904419798320812097681858652325473791891232710431997202897819580634937070900625213218095330766877190212418023297341732808839488308551126409983193</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">6569689420274066957835983390583585286570087619048110141187700584193792695235405077811544355169290382357149374107076406086154103351897890793598997687053983</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">18503782836858540043974558035601654610948915505645219820150251062305120148745545906567548650191832090823482852604346478335353784501076761922605361848703623</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">4508246168044513518452493882713536390636741541551805821790338973797615971271867248584379813114125478195284692695928668946553625483179633266057122967547052</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">23383087478545512218713157932934746110721706819077423418060220083657713428503582801909807142802647367994289775015595100541168367083097506193809451365010723</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">22966105670291282335588843018244161552764486373117942865966904076191122337435542553276743938817686729554714315494818922753880198945897222422137268427611672</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">31775649089861428671057909076144152870796722528112580479442073365053916012507273433028451755436987054722496057749731758475958301164082755003195632005308493</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">17963313063405045742968136916219838352135561785389534381262979264585397896844470879023686508540355160998533122970239261072020689217153126649390825646712087</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">22246342022943432820696190444155665289928378653841172632283227888174495402248633061010615572642126584591103750338919213945646074833823905521643025879053949</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">1652417534709029450380570653973705320986117679597563873022683140800507482560482948310131540948227797045505390333146191586749269249548168247316404074014639</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">25395461142670631268156106136028325744393358436617528677967249347353524924655001151849544022201772500033280822372661344352607434738696051779095736547813043</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">15585771734488351039456631394040497759568679429510619219766191780807675361741859290490732451112648776648126779759368428205194684721516497026290981786239352</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">32056508892744184901289413287728039891303832311548608141088227876326753674154124775132776928481935378184756756785107540781632570295330486738268173167809047</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">8965123421637694050044216844523379163347478029124815032832813225050732558524239660648746284884140746788823681886010577342254841014594570067467905682359797</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">52849766269541827474228189428820648574162539595985395992261649809907435742263020551050064268890333392877173572811691599841253150460219986817964461970736553</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;c&quot;</span>: <span class="number">13560945756543023008529388108446940847137853038437095244573035888531288577370829065666320069397898394848484847030321018915638381833935580958342719988978247</span>, <span class="string">&quot;e&quot;</span>: <span class="number">10</span>, <span class="string">&quot;n&quot;</span>: <span class="number">30415984800307578932946399987559088968355638354344823359397204419191241802721772499486615661699080998502439901585573950889047918537906687840725005496238621</span>&#125;]</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> session <span class="keyword">in</span> sessions:</span><br><span class="line">    e = session[<span class="string">&#x27;e&#x27;</span>]</span><br><span class="line">    n = session[<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line">    msg = session[<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">    data = data + [(msg, n)]</span><br><span class="line">x, n = chinese_remainder_theorem(data)</span><br><span class="line">e = session[<span class="string">&#x27;e&#x27;</span>]</span><br><span class="line">x,q=iroot(<span class="built_in">int</span>(x),<span class="number">10</span>)</span><br><span class="line">print(long_to_bytes(x))</span><br></pre></td></tr></table></figure>
<p>还有一种官方解法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e=<span class="number">10</span></span><br><span class="line">c1=gmpy2.mpz(<span class="string">&quot;7366067574741171461722065133242916080495505913663250330082747465383676893970411476550748394841437418105312353971095003424322679616940371123028982189502042&quot;</span>)</span><br><span class="line">n1=gmpy2.mpz(<span class="string">&quot;25162507052339714421839688873734596177751124036723831003300959761137811490715205742941738406548150240861779301784133652165908227917415483137585388986274803&quot;</span>)</span><br><span class="line">c2=gmpy2.mpz(<span class="string">&quot;21962825323300469151795920289886886562790942771546858500842179806566435767103803978885148772139305484319688249368999503784441507383476095946258011317951461&quot;</span>)</span><br><span class="line">n2=gmpy2.mpz(<span class="string">&quot;23976859589904419798320812097681858652325473791891232710431997202897819580634937070900625213218095330766877190212418023297341732808839488308551126409983193&quot;</span>)</span><br><span class="line">c3=gmpy2.mpz(<span class="string">&quot;6569689420274066957835983390583585286570087619048110141187700584193792695235405077811544355169290382357149374107076406086154103351897890793598997687053983&quot;</span>)</span><br><span class="line">n3=gmpy2.mpz(<span class="string">&quot;18503782836858540043974558035601654610948915505645219820150251062305120148745545906567548650191832090823482852604346478335353784501076761922605361848703623&quot;</span>)</span><br><span class="line">c4=gmpy2.mpz(<span class="string">&quot;4508246168044513518452493882713536390636741541551805821790338973797615971271867248584379813114125478195284692695928668946553625483179633266057122967547052&quot;</span>)</span><br><span class="line">n4=gmpy2.mpz(<span class="string">&quot;23383087478545512218713157932934746110721706819077423418060220083657713428503582801909807142802647367994289775015595100541168367083097506193809451365010723&quot;</span>)</span><br><span class="line">c5=gmpy2.mpz(<span class="string">&quot;22966105670291282335588843018244161552764486373117942865966904076191122337435542553276743938817686729554714315494818922753880198945897222422137268427611672&quot;</span>)</span><br><span class="line">n5=gmpy2.mpz(<span class="string">&quot;31775649089861428671057909076144152870796722528112580479442073365053916012507273433028451755436987054722496057749731758475958301164082755003195632005308493&quot;</span>)</span><br><span class="line">c6=gmpy2.mpz(<span class="string">&quot;17963313063405045742968136916219838352135561785389534381262979264585397896844470879023686508540355160998533122970239261072020689217153126649390825646712087&quot;</span>)</span><br><span class="line">n6=gmpy2.mpz(<span class="string">&quot;22246342022943432820696190444155665289928378653841172632283227888174495402248633061010615572642126584591103750338919213945646074833823905521643025879053949&quot;</span>)</span><br><span class="line">c7=gmpy2.mpz(<span class="string">&quot;1652417534709029450380570653973705320986117679597563873022683140800507482560482948310131540948227797045505390333146191586749269249548168247316404074014639&quot;</span>)</span><br><span class="line">n7=gmpy2.mpz(<span class="string">&quot;25395461142670631268156106136028325744393358436617528677967249347353524924655001151849544022201772500033280822372661344352607434738696051779095736547813043&quot;</span>)</span><br><span class="line">c8=gmpy2.mpz(<span class="string">&quot;15585771734488351039456631394040497759568679429510619219766191780807675361741859290490732451112648776648126779759368428205194684721516497026290981786239352&quot;</span>)</span><br><span class="line">n8=gmpy2.mpz(<span class="string">&quot;32056508892744184901289413287728039891303832311548608141088227876326753674154124775132776928481935378184756756785107540781632570295330486738268173167809047&quot;</span>)</span><br><span class="line">c9=gmpy2.mpz(<span class="string">&quot;8965123421637694050044216844523379163347478029124815032832813225050732558524239660648746284884140746788823681886010577342254841014594570067467905682359797&quot;</span>)</span><br><span class="line">n9=gmpy2.mpz(<span class="string">&quot;52849766269541827474228189428820648574162539595985395992261649809907435742263020551050064268890333392877173572811691599841253150460219986817964461970736553&quot;</span>)</span><br><span class="line">c0=gmpy2.mpz(<span class="string">&quot;13560945756543023008529388108446940847137853038437095244573035888531288577370829065666320069397898394848484847030321018915638381833935580958342719988978247&quot;</span>)</span><br><span class="line">n0=gmpy2.mpz(<span class="string">&quot;30415984800307578932946399987559088968355638354344823359397204419191241802721772499486615661699080998502439901585573950889047918537906687840725005496238621&quot;</span>)</span><br><span class="line">M=n1*n2*n3*n4*n5*n6*n7*n8*n9*n0</span><br><span class="line">m1=M//n1</span><br><span class="line">m2=M//n2</span><br><span class="line">m3=M//n3</span><br><span class="line">m4=M//n4</span><br><span class="line">m5=M//n5</span><br><span class="line">m6=M//n6</span><br><span class="line">m7=M//n7</span><br><span class="line">m8=M//n8</span><br><span class="line">m9=M//n9</span><br><span class="line">m0=M//n0</span><br><span class="line">t1=c1*m1*gmpy2.invert(m1,n1)</span><br><span class="line">t2=c2*m2*gmpy2.invert(m2,n2)</span><br><span class="line">t3=c3*m3*gmpy2.invert(m3,n3)</span><br><span class="line">t4=c4*m4*gmpy2.invert(m4,n4)</span><br><span class="line">t5=c5*m5*gmpy2.invert(m5,n5)</span><br><span class="line">t6=c6*m6*gmpy2.invert(m6,n6)</span><br><span class="line">t7=c7*m7*gmpy2.invert(m7,n7)</span><br><span class="line">t8=c8*m8*gmpy2.invert(m8,n8)</span><br><span class="line">t9=c9*m9*gmpy2.invert(m9,n9)</span><br><span class="line">t0=c0*m0*gmpy2.invert(m0,n0)</span><br><span class="line">x=(t1+t2+t3+t4+t5+t6+t7+t8+t9+t0)%M</span><br><span class="line">m,q=gmpy2.iroot(x,e)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">榉橡</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2021/03/23/rsa%E5%AD%A6%E4%B9%A0%E7%BB%88%E7%BB%93/">http://example.com/2021/03/23/rsa%E5%AD%A6%E4%B9%A0%E7%BB%88%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">榉橡的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="E:\blog\themes\butterfly\source\img" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/03/25/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/"><img class="prev-cover" src="E:\blog\themes\butterfly\source\img" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">中国剩余定理</div></div></a></div><div class="next-post pull-right"><a href="/2021/03/20/%E6%9C%AC%E5%91%A8%E8%AE%AD%E7%BB%83%E7%AC%AC%E4%B8%80%E6%AC%A1/"><img class="next-cover" src="E:\blog\themes\butterfly\source\img" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">本周训练第一次</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/02/19/ACTF-Junior-2021-write-up/" title="ACTF_Junior_2021_write_up"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">ACTF_Junior_2021_write_up</div></div></a></div><div><a href="/2021/03/02/RSA学习笔记/" title="RSA学习笔记"><img class="cover" src="E:\blog\themes\butterfly\source\img" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-02</div><div class="title">RSA学习笔记</div></div></a></div><div><a href="/2021/02/27/PHP伪协议/" title="PHP伪协议"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-27</div><div class="title">PHP伪协议</div></div></a></div><div><a href="/2021/03/16/base原理-隐写/" title="base原理+隐写"><img class="cover" src="E:\blog\themes\butterfly\source\img" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-16</div><div class="title">base原理+隐写</div></div></a></div><div><a href="/2021/03/17/git源码泄露/" title="git源码泄露"><img class="cover" src="E:\blog\themes\butterfly\source\img" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-17</div><div class="title">git源码泄露</div></div></a></div><div><a href="/2021/03/18/thinkphp5远程漏洞/" title="thinkphp5远程漏洞"><img class="cover" src="E:\blog\themes\butterfly\source\img" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-18</div><div class="title">thinkphp5远程漏洞</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/null" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">榉橡</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA%E5%AD%A6%E4%B9%A0%E7%BB%88%E7%BB%93%E2%80%94-%E4%BE%8B%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">RSA学习终结—-例题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E9%92%A5d%E7%9A%84%E7%94%9F%E6%88%90"><span class="toc-number">1.1.</span> <span class="toc-text">密钥d的生成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%EF%BC%88%E5%B7%B2%E7%9F%A5p-q-e-c%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">解密（已知p,q,e,c）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%EF%BC%88%E5%B7%B2%E7%9F%A5p-q-dp-dq-c%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">解密（已知p,q,dp,dq,c）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB%EF%BC%88%E4%B8%A4%E6%AE%B5%E5%AF%86%E6%96%87%EF%BC%8Cn%E7%9B%B8%E5%90%8C%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">共模攻击（两段密文，n相同）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rsa%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86-https-blog-csdn-net-MikeCoke-article-details-106065200"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">rsa共模攻击数学原理   https:&#x2F;&#x2F;blog.csdn.net&#x2F;MikeCoke&#x2F;article&#x2F;details&#x2F;106065200</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dp%E6%B3%84%E9%9C%B2%EF%BC%88%E5%B7%B2%E7%9F%A5n-e-dp-c%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">dp泄露（已知n,e,dp,c）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%8A%A0%E7%AD%BE%EF%BC%88%E7%BB%99%E5%87%BA%E5%85%AC%E9%92%A5%E6%96%87%E4%BB%B6%E5%92%8C%E5%8A%A0%E5%AF%86%E6%96%87%E4%BB%B6%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">公钥加签（给出公钥文件和加密文件）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rsaroll"><span class="toc-number">2.</span> <span class="toc-text">rsaroll</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#e%E8%BF%87%E5%B0%8F"><span class="toc-number">2.1.</span> <span class="toc-text">e过小</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="toc-number">2.2.</span> <span class="toc-text">低加密指数广播攻击</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/03/25/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/" title="中国剩余定理"><img src="E:\blog\themes\butterfly\source\img" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="中国剩余定理"/></a><div class="content"><a class="title" href="/2021/03/25/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/" title="中国剩余定理">中国剩余定理</a><time datetime="2021-03-25T03:11:00.000Z" title="发表于 2021-03-25 11:11:00">2021-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/23/rsa%E5%AD%A6%E4%B9%A0%E7%BB%88%E7%BB%93/" title="rsa学习终结"><img src="E:\blog\themes\butterfly\source\img" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="rsa学习终结"/></a><div class="content"><a class="title" href="/2021/03/23/rsa%E5%AD%A6%E4%B9%A0%E7%BB%88%E7%BB%93/" title="rsa学习终结">rsa学习终结</a><time datetime="2021-03-23T02:15:10.000Z" title="发表于 2021-03-23 10:15:10">2021-03-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/20/%E6%9C%AC%E5%91%A8%E8%AE%AD%E7%BB%83%E7%AC%AC%E4%B8%80%E6%AC%A1/" title="本周训练第一次"><img src="E:\blog\themes\butterfly\source\img" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="本周训练第一次"/></a><div class="content"><a class="title" href="/2021/03/20/%E6%9C%AC%E5%91%A8%E8%AE%AD%E7%BB%83%E7%AC%AC%E4%B8%80%E6%AC%A1/" title="本周训练第一次">本周训练第一次</a><time datetime="2021-03-20T07:44:35.000Z" title="发表于 2021-03-20 15:44:35">2021-03-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/18/thinkphp5%E8%BF%9C%E7%A8%8B%E6%BC%8F%E6%B4%9E/" title="thinkphp5远程漏洞"><img src="E:\blog\themes\butterfly\source\img" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="thinkphp5远程漏洞"/></a><div class="content"><a class="title" href="/2021/03/18/thinkphp5%E8%BF%9C%E7%A8%8B%E6%BC%8F%E6%B4%9E/" title="thinkphp5远程漏洞">thinkphp5远程漏洞</a><time datetime="2021-03-18T01:34:39.000Z" title="发表于 2021-03-18 09:34:39">2021-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/17/git%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/" title="git源码泄露"><img src="E:\blog\themes\butterfly\source\img" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="git源码泄露"/></a><div class="content"><a class="title" href="/2021/03/17/git%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/" title="git源码泄露">git源码泄露</a><time datetime="2021-03-17T12:22:14.000Z" title="发表于 2021-03-17 20:22:14">2021-03-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 榉橡</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"live2d-widget-model-<你喜欢的模型名字>"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body></html>